<i class="scanex-tristate" class:selected="state === 1" class:unselected="state === 0" class:indeterminate="state === 2" on:click="toggle(event)"></i>

<script>

    export default {
        data () {
            return {                
                items: [],
                exclude: [],
                state: 0,
            };
        },
        onupdate ({changed, current}) {
            if (changed.items) {
                const {exclude} = this.get();
                if (current.items.every (({checked}, i) => exclude.indexOf(i) === -1 && checked)) {
                    this.set({state: 1});
                }
                else if (current.items.every (({checked}, i) => exclude.indexOf(i) === -1 && !checked)) {
                    this.set({state: 0});
                }
                else if (current.items.every (({checked}, i) => exclude.indexOf(i) === -1)) {
                    this.set({state: 2});
                }
            }
        },
        methods: {
            toggle (e) {
                e.stopPropagation();
                const {state, items} = this.get();
                switch (state) {
                    case 0:
                    case 2:
                        items.forEach(item => {
                            item.checked = true;
                        });
                        this.set({items});                        
                        break;
                    case 1:
                        items.forEach(item => {
                            item.checked = false;
                        });
                        this.set({items});                        
                        break;                                            
                    default:
                        break;
                }
            }
        }
    };
</script>